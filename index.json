[{"body":"","link":"https://blog.rogerogers.com/posts/dev/","section":"posts","tags":null,"title":"dev"},{"body":"","link":"https://blog.rogerogers.com/","section":"","tags":null,"title":""},{"body":"","link":"https://blog.rogerogers.com/tags/cni/","section":"tags","tags":null,"title":"cni"},{"body":"","link":"https://blog.rogerogers.com/tags/containerd/","section":"tags","tags":null,"title":"containerd"},{"body":"Install 1# ubuntu debain and other debain base distribution 2sudo apt install crictl -y 3# centos fedora and other red hat base distribution 4sudo yum install crictl -y You can download directly from github release page\nCreate /etc/crictl.yaml 1runtime-endpoint: \u0026#34;unix:///run/containerd/containerd.sock\u0026#34; 2image-endpoint: \u0026#34;\u0026#34; 3timeout: 0 4debug: false 5pull-image-on-create: false 6disable-pull-on-run: false Create pod config pod-config.yaml 1metadata: 2 attempt: 1 3 name: nginx-sandbox 4 namespace: default 5 uid: hdishd83djaidwnduwk28bcsb 6log_directory: /tmp 7linux: 8 namespaces: 9 options: {} Create container config container-config.yaml 1metadata: 2 name: nginx 3image: 4 image: docker.io/nginx:alpine 5log_path: nginx.log 1crictl run container-config.json pod-config.json 2crictl ps -a 3#CONTAINER IMAGE CREATED STATE NAME ATTEMPT POD ID POD 4#86f1c7a2aaffe nginx 23 minutes ago Running nginx 0 dd6d7d4ea70cd unknown 5crictl start 86f1c7a2aaffe 6crictl ps 7crictl pods 8#POD ID CREATED STATE NAME NAMESPACE ATTEMPT RUNTIME 9#dd6d7d4ea70cd About an hour ago Ready nginx default 1 (default) 10crictl port-forward dd6d7d4ea70cd 80:80 11curl localhost 12#welcome to nginx ","link":"https://blog.rogerogers.com/posts/ops/crictl-usage/","section":"posts","tags":["linux","k8s","kubernetes","cni","containerd"],"title":"Crictl usage"},{"body":"","link":"https://blog.rogerogers.com/tags/k8s/","section":"tags","tags":null,"title":"k8s"},{"body":"","link":"https://blog.rogerogers.com/tags/kubernetes/","section":"tags","tags":null,"title":"kubernetes"},{"body":"","link":"https://blog.rogerogers.com/tags/linux/","section":"tags","tags":null,"title":"linux"},{"body":"","link":"https://blog.rogerogers.com/posts/ops/","section":"posts","tags":["linux","k8s","kubernetes"],"title":"ops"},{"body":"","link":"https://blog.rogerogers.com/tags/","section":"tags","tags":null,"title":"Tags"},{"body":"","link":"https://blog.rogerogers.com/tags/mac/","section":"tags","tags":null,"title":"mac"},{"body":"","link":"https://blog.rogerogers.com/tags/multipass/","section":"tags","tags":null,"title":"multipass"},{"body":"Docker desktop costs so much to run\nInstall multipass\n1brew install --cask multipass 2# specific resource, default cpu 1, default disk 5G 3multipass launch --name linux -d 10G -m 4 4# shortcut, alias make command easy 5alias m=multipass 6m launch linux Here i use homebrew. You can download directly multipass release\nNow you are in linux env, you login by ubuntu with sudo permission\n1sudo apt install docker docker.io 2#or you prefer containerd 3sudo apt install containerd crictl Use Docker command to manage your container You can mount your local path into instance\n1# pwd $HOME 2m mount -u 501:1000 $HOME/Public linux01:/tmp/public 3# pay attention on the policy of you mount dir ","link":"https://blog.rogerogers.com/posts/dev/run-docker-on-mac-use-multipass/","section":"posts","tags":["linux","mac","multipass"],"title":"Run Docker on mac use multipass"},{"body":"root needed\nubuntu 1apt-get update \u0026amp;\u0026amp; apt-get install -y apt-transport-https 2curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - 3cat \u0026lt;\u0026lt;EOF \u0026gt;/etc/apt/sources.list.d/kubernetes.list 4deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main 5EOF 6apt-get update 7apt-get install -y kubelet kubeadm kubectl 8#close swap 9swapoff -a 10#remove swap mount 11vi /etc/fstab apt-key is deprecated in some new version linux distribution, like ubuntu, put gpg file inside /etc/apt/trusted.gpg.d\nfedora 1cat \u0026lt;\u0026lt;EOF \u0026gt; /etc/yum.repos.d/kubernetes.repo 2[kubernetes] 3name=Kubernetes 4baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/ 5enabled=1 6gpgcheck=1 7repo_gpgcheck=1 8gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg 9EOF 10#close selinux 11setenforce 0 12#disable selinux 13sed -i \u0026#39;s/SELINUX=enforcing/SELINUX=disabled/g\u0026#39; 14#disable firewalld 15systemctl disable firewalld.service 16 17dnf update \u0026amp;\u0026amp; dnf install -y kubelet kubeadm kubectl 18systemctl enable --now kubelet 19#close swap 20swapoff -a 21#disable swap 22dnf remove zram-generator-defaults config 1apiVersion: kubeadm.k8s.io/v1beta3 2bootstrapTokens: 3 - groups: 4 - system:bootstrappers:kubeadm:default-node-token 5 token: abcdef.0123456789abcdef 6 ttl: 24h0m0s 7 usages: 8 - signing 9 - authentication 10kind: InitConfiguration 11localAPIEndpoint: 12 #apiserver address 13 advertiseAddress: 192.168.1.2 14 bindPort: 6443 15nodeRegistration: 16 # use containerd, docker is deprecated 17 criSocket: unix:///var/run/containerd/containerd.sock 18 imagePullPolicy: IfNotPresent 19 # node must visis 20 name: node 21 taints: null 22--- 23apiServer: 24 timeoutForControlPlane: 4m0s 25apiVersion: kubeadm.k8s.io/v1beta3 26certificatesDir: /etc/kubernetes/pki 27clusterName: kubernetes 28controllerManager: {} 29imageRepository: registry.cn-hangzhou.aliyuncs.com/google_containers 30dns: {} 31etcd: 32 external: 33 # external etcd, you may use etcd provide by kubeadm 34 endpoints: 35 - https://192.168.1.2:2379 36 caFile: /etc/etcd/pki/ca.crt 37 certFile: /etc/etcd/pki/apiserver-etcd-client.crt 38 keyFile: /etc/etcd/pki/apiserver-etcd-client.key 39 40kind: ClusterConfiguration 41# latest version 42kubernetesVersion: 1.24.1 43networking: 44 dnsDomain: cluster.local 45 # here we use flannel cni plugin, you may change you use others such as calico 46 podSubnet: 10.244.0.0/16 47 serviceSubnet: 10.96.0.0/12 48scheduler: {} you can use kubeadm config print init-defaults print the latest version\nchange kernel param 1cat \u0026lt;\u0026lt;EOF | sudo tee /etc/modules-load.d/k8s.conf 2br_netfilter 3overlay 4EOF 5 6cat \u0026lt;\u0026lt;EOF | sudo tee /etc/sysctl.d/k8s.conf 7net.bridge.bridge-nf-call-ip6tables = 1 8net.bridge.bridge-nf-call-iptables = 1 9net.ipv4.ip_forward=1 10EOF maybe need load immediately\n1modprobe br_netfilter overlay 1#pull image first 2kubeadm config images pull --config kubeadm-init-config.yaml 3#init 4kubeadm init --config kubeadm-init-config.yaml 5#allow single node cluster run pod 6kubectl taint nodes --all node-role.kubernetes.io/control-plane- node-role.kubernetes.io/master- 1mkdir $HOME/.kube \u0026amp;\u0026amp; sudo cp /etc/kubenertes/admin.conf $HOME/.kube/config 2kubectl get node you will see k8s pod runing\n","link":"https://blog.rogerogers.com/posts/ops/create-kubernetes-use-kubeadm/","section":"posts","tags":["linux","k8s","kubernetes"],"title":"Create kubernetes use kubeadm"},{"body":"","link":"https://blog.rogerogers.com/categories/","section":"categories","tags":null,"title":"Categories"},{"body":"","link":"https://blog.rogerogers.com/categories/dev/","section":"categories","tags":null,"title":"dev"},{"body":"","link":"https://blog.rogerogers.com/tags/docker/","section":"tags","tags":null,"title":"docker"},{"body":"","link":"https://blog.rogerogers.com/categories/k8s/","section":"categories","tags":null,"title":"k8s"},{"body":"","link":"https://blog.rogerogers.com/tags/ops/","section":"tags","tags":null,"title":"ops"},{"body":"","link":"https://blog.rogerogers.com/categories/ops/","section":"categories","tags":null,"title":"ops"},{"body":"Install apt install podman\nconfig On linux platform, podman put it's config in /etc/containers\nwe need config registries.yaml first\nfill the unqualified-search-registries config so you can searching or pulling by short names\nuse a local register to speed your pulling image insecure=true allow you skipping TLS verification\n1[[registry]] 2location=\u0026#34;localhost:5000\u0026#34; 3insecure=true you can blocking a registry, namespace, or image by set blocked=true\nconfig a mirror 1[[registry]] 2location=\u0026#34;registry.access.redhat.com\u0026#34; 3[[registry.mirror]] 4location=\u0026#34;internal.registry.mirror\u0026#34; Run podman has many of docker command, simplest you can just alias your docker command to podman\nalways run on when system reboot\nuse systemd\npodman provide simple command to generate a systemd config\npodman generate systemd --new --name redis \u0026gt; /etc/systemd/system/redis.service\nsystemctl enable --now redis\nthis will keep redis on when system reboot\n","link":"https://blog.rogerogers.com/posts/ops/using-podman-instead-docker/","section":"posts","tags":["docker","ops"],"title":"Using podman instead docker"},{"body":"","link":"https://blog.rogerogers.com/tags/golang/","section":"tags","tags":null,"title":"golang"},{"body":"","link":"https://blog.rogerogers.com/categories/golang/","section":"categories","tags":null,"title":"golang"},{"body":"","link":"https://blog.rogerogers.com/tags/grpc/","section":"tags","tags":null,"title":"grpc"},{"body":"","link":"https://blog.rogerogers.com/categories/grpc/","section":"categories","tags":null,"title":"grpc"},{"body":"1.Install protoc use apt\nsudo apt install protoc\nor download release from github direct, here i use ubuntu, for other platform, visit protocol\nwget https://github.com/protocolbuffers/protobuf/releases/download/v3.19.4/protoc-3.19.4-linux-x86_64.zip -o ${HOME}/.local/bin\n2.install protoc-gen-go go install google.golang.org/protobuf/cmd/protoc-gen-go@latest\ngo install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest\n3.write example code 1syntax = \u0026#34;proto3\u0026#34;; 2 3option go_package = \u0026#34;proto/ecommerce\u0026#34;; 4package ecommerce; 5 6message ProductID { string value = 1; } 7 8message Product { 9 string id = 1; 10 string name = 2; 11 string description = 3; 12} 13 14service ProductInfo { 15 rpc addProduct(Product) returns (ProductID); 16 rpc getProduct(ProductID) returns (Product); 17} and put this in a proto folder\n4.Gen proto for golang and grpc 1protoc --go_out=. --go_opt=paths=source_relative \\ 2 --go-grpc_out=. --go-grpc_opt=paths=source_relative proto/product_info.proto Explains of this options go_out define where to put your code go_opt define go_out options paths=import mean create the full import path of option go_package in your proto file, and paths=source_relative will ignore this module in go_opt will sub the prefix of you go_package option Now you can use it in you project\nJust a record, i'm still learning\n","link":"https://blog.rogerogers.com/posts/dev/protocol-buffers-with-golang/","section":"posts","tags":["golang","grpc"],"title":"Protocol-buffers with golang"},{"body":"Here are some ideas to get you started:\n🔭 I’m currently working on Golang, Python 🌱 I’m currently learning Rust 🤔 I’m looking for help with Rust 💬 Ask me about Golang, Python, Linux, DevOps, Kubernetes, Rust 😄 Pronouns: rogerogers ","link":"https://blog.rogerogers.com/about/","section":"","tags":null,"title":"About"},{"body":"","link":"https://blog.rogerogers.com/posts/","section":"posts","tags":["golang","rust","k8s","grpc"],"title":"Posts"},{"body":"","link":"https://blog.rogerogers.com/tags/rust/","section":"tags","tags":null,"title":"rust"},{"body":"","link":"https://blog.rogerogers.com/categories/rust/","section":"categories","tags":null,"title":"rust"},{"body":"I'm begin learning rust.\n","link":"https://blog.rogerogers.com/posts/dev/learn-rust/","section":"posts","tags":["rust"],"title":"Begin learn rust"},{"body":"I'm begin learning golang.\n","link":"https://blog.rogerogers.com/posts/dev/learn-golang/","section":"posts","tags":["golang"],"title":"Begin learning golang"},{"body":"","link":"https://blog.rogerogers.com/archives/","section":"","tags":null,"title":""},{"body":"Tradução em português. Apenas para demonstração, o resto do artigo não está traduzido.\nWritten in Go, Hugo is an open source static site generator available under the Apache Licence 2.0. Hugo supports TOML, YAML and JSON data file types, Markdown and HTML content files and uses shortcodes to add rich content. Other notable features are taxonomies, multilingual mode, image processing, custom output formats, HTML/CSS/JS minification and support for Sass SCSS workflows.\nHugo makes use of a variety of open source projects including:\nhttps://github.com/yuin/goldmark https://github.com/alecthomas/chroma https://github.com/muesli/smartcrop https://github.com/spf13/cobra https://github.com/spf13/viper Hugo is ideal for blogs, corporate websites, creative portfolios, online magazines, single page applications or even a website with thousands of pages.\nHugo is for people who want to hand code their own website without worrying about setting up complicated runtimes, dependencies and databases.\nWebsites built with Hugo are extremelly fast, secure and can be deployed anywhere including, AWS, GitHub Pages, Heroku, Netlify and any other hosting provider.\nLearn more and contribute on GitHub.\n","link":"https://blog.rogerogers.com/about.pt/","section":"","tags":null,"title":"Sobre"},{"body":"","link":"https://blog.rogerogers.com/series/","section":"series","tags":null,"title":"Series"}]